---
title: 톰캣 로그로 인한 스토리지 문제

date: 2022-01-26 23:11:00 +0900

categories: [tomcat]

tags: [tomcat]
---

###  TOMCAT이 올라간 서버가 storage 용량이 부족해서 기능이 동작안하는 사례가 있었다.
1. 루트(/)스토리지 용량이 부족하여 용량이 그냥 부족한 줄 알았으나, logs 파일에서 과도하게 용량잡고있는 것을 확인하였다.
2. 추가로 확인을 하던 도중 tomcat cache 문제로 과도하게 찍히고 있는 내용 확인.
3. tomcat에서 cache설정을 늘려주고, 서버에서 로그 찍는 옵션을 줄여 처리하였음
---
# 추가 확인 내용

1. 이미지 용량이 과도하여 cache설정으로 할 수 있는게 아니라고 판단하여 로그 찍는 옵션을 수정한게 효과적이었다.
   - jpg 용량을 퀄리티를 반으로 내려서 올리는 로직이 들어가있었는데 30메가 짜리 이미지가 있는걸로보아 어마어마한 이미지 파일이 올라가려 했던것으로 추정
   - 일단 해결하고 용량 관련 제한을 front에서 체크로직 추가했음
   - 업로드 된 이미지에 대해 용량 제한을 걸어 WAS cache 사용량을 줄여보고 로그 추이를 보자
   - **TOMCAT 에서 못보던 로그가 찍히면 확인을 해보자**



